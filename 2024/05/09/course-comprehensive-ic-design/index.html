<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>course_comprehensive_ic_design - Debussy</title>
  
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/sukiDebussy/pictures@master/test/favicon.ico">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="course_comprehensive_ic_design - Debussy" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://sukidebussy.blog.com/2024/05/09/course-comprehensive-ic-design/index.html" />
  
  <meta property="og:image" content="/favicon.ico" />
  
  <meta property="og:article:published_time" content="2024-05-09T09:03:04.000Z" />
  
  <meta property="og:article:author" content="Yun Zhang" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="light"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="always"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="4"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Debussy&#39;s Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/projects">Projects</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/sukiDebussy" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        

        
        <div class="date" id="date">
            <span>May</span>
            <span>9,</span>
            <span>2024</span>
        </div>
        

        <h1 class="title">course_comprehensive_ic_design</h1>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="专业综合实验过程记录">专业综合实验过程记录</h1>
<h2 id="实验1">实验1</h2>
<h3 id="加法器">加法器</h3>
<h4 id="一位全加器">一位全加器</h4>
<p>对移位全加器而言，不同的写法有不同的综合结果。</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> adder(</span><br><span class="line">    <span class="keyword">input</span> i_x,</span><br><span class="line">    <span class="keyword">input</span> i_y,</span><br><span class="line">    <span class="keyword">input</span> i_cin,</span><br><span class="line">    <span class="keyword">output</span> o_sum,</span><br><span class="line">    <span class="keyword">output</span> o_cout</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">wire</span> w_p, w_g;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> w_p = i_x ^ i_y;</span><br><span class="line">    <span class="keyword">assign</span> w_g = i_x &amp; i_y;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_sum = w_p ^ i_cin;</span><br><span class="line">    <span class="keyword">assign</span> o_cout = (w_p &amp; i_cin) | w_g;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>RTL分析：</p>
<figure>
<img src="https://s2.loli.net/2024/05/09/Zy6N7ITeQPqMVti.png" alt="image-20240509170552029">
<figcaption aria-hidden="true">image-20240509170552029</figcaption>
</figure>
<p>综合结果如下。可以看到FPGA内部通过查找表实现组合逻辑电路。</p>
<figure>
<img src="https://s2.loli.net/2024/05/09/pnsWNGCzhS527HV.png" alt="image-20240509170736387">
<figcaption aria-hidden="true">image-20240509170736387</figcaption>
</figure>
<p>如果直接写加法：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> adder(</span><br><span class="line">    <span class="keyword">input</span> i_x,</span><br><span class="line">    <span class="keyword">input</span> i_y,</span><br><span class="line">    <span class="keyword">input</span> i_cin,</span><br><span class="line">    <span class="keyword">output</span> o_sum,</span><br><span class="line">    <span class="keyword">output</span> o_cout</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">assign</span> {o_cout, o_sum} = i_x + i_y + i_cin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>RTL分析：</p>
<figure>
<img src="https://s2.loli.net/2024/05/09/fLGieRFmoXrlqjs.png" alt="image-20240509171015390">
<figcaption aria-hidden="true">image-20240509171015390</figcaption>
</figure>
<p>综合电路不变。vivado都会使用查找表（LUT）实现电路。</p>
<h4 id="超前进位加法器">超前进位加法器</h4>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 9th May 2024 16:38:42</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Thursday, 9th May 2024 22:02:16</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: One-bit full adder</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> m_adder(</span><br><span class="line">        <span class="keyword">input</span> i_x,</span><br><span class="line">        <span class="keyword">input</span> i_y,</span><br><span class="line">        <span class="keyword">input</span> i_cin,</span><br><span class="line">        <span class="keyword">output</span> o_sum,</span><br><span class="line">        <span class="keyword">output</span> o_p,</span><br><span class="line">        <span class="keyword">output</span> o_g</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">wire</span> w_p, w_g;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_p = w_p;</span><br><span class="line">    <span class="keyword">assign</span> o_g = w_g;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> w_p = i_x ^ i_y;</span><br><span class="line">    <span class="keyword">assign</span> w_g = i_x &amp; i_y;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_sum = w_p ^ i_cin;</span><br><span class="line">    <span class="keyword">assign</span> o_cout = (w_p &amp; i_cin) | w_g;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 9th May 2024 18:51:45</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Thursday, 9th May 2024 22:02:12</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: carry lookahead adder with parameter NUM_BITS</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> m_cla # (</span><br><span class="line">    <span class="keyword">parameter</span> NUM_BITS = <span class="number">4</span></span><br><span class="line">) (</span><br><span class="line">    <span class="keyword">input</span> i_cin,</span><br><span class="line">    <span class="keyword">input</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_p,</span><br><span class="line">    <span class="keyword">input</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_g,</span><br><span class="line">    <span class="keyword">output</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] o_c</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] w_c;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_c = w_c;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> w_c[<span class="number">0</span>] = (i_p[<span class="number">0</span>] &amp; i_cin) | i_g[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">genvar</span> i;</span><br><span class="line">    <span class="keyword">generate</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; NUM_BITS; i = i + <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">assign</span> w_c[i] = (i_p[i] &amp; w_c[i - <span class="number">1</span>]) | i_g[i];</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">endgenerate</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 9th May 2024 18:27:09</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Friday, 10th May 2024 00:01:28</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: top module for carry lookahead adder with parameter NUM_BITS</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> m_adder_fast_top # (</span><br><span class="line">        <span class="keyword">parameter</span> NUM_BITS = <span class="number">4</span></span><br><span class="line">    ) (</span><br><span class="line">        <span class="keyword">input</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_a,</span><br><span class="line">        <span class="keyword">input</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_b,</span><br><span class="line">        <span class="keyword">input</span> i_cin,</span><br><span class="line">        <span class="keyword">output</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] o_sum,</span><br><span class="line">        <span class="keyword">output</span> o_cout</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] w_p, w_g;</span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] w_c;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_cout = w_c[NUM_BITS - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">genvar</span> i;</span><br><span class="line">    <span class="keyword">generate</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; NUM_BITS; i = i + <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">                m_adder adder_inst(</span><br><span class="line">                            <span class="variable">.i_x</span>    (i_a[<span class="number">0</span>]     ),</span><br><span class="line">                            <span class="variable">.i_y</span>    (i_b[<span class="number">0</span>]     ),</span><br><span class="line">                            <span class="variable">.i_cin</span>  (i_cin      ),</span><br><span class="line">                            <span class="variable">.o_sum</span>  (o_sum[<span class="number">0</span>]   ),</span><br><span class="line">                            <span class="variable">.o_p</span>    (w_p[<span class="number">0</span>]     ),</span><br><span class="line">                            <span class="variable">.o_g</span>    (w_g[<span class="number">0</span>]     )</span><br><span class="line">                        );</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                m_adder adder_inst(</span><br><span class="line">                            <span class="variable">.i_x</span>    (i_a[i]     ),</span><br><span class="line">                            <span class="variable">.i_y</span>    (i_b[i]     ),</span><br><span class="line">                            <span class="variable">.i_cin</span>  (w_c[i-<span class="number">1</span>]   ),</span><br><span class="line">                            <span class="variable">.o_sum</span>  (o_sum[i]   ),</span><br><span class="line">                            <span class="variable">.o_p</span>    (w_p[i]     ),</span><br><span class="line">                            <span class="variable">.o_g</span>    (w_g[i]     )</span><br><span class="line">                        );</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">endgenerate</span></span><br><span class="line"></span><br><span class="line">    m_cla #(</span><br><span class="line">              <span class="variable">.NUM_BITS</span>(NUM_BITS)</span><br><span class="line">          )cla_inst(</span><br><span class="line">              <span class="variable">.i_cin</span>  (i_cin      ),</span><br><span class="line">              <span class="variable">.i_p</span>    (w_p        ),</span><br><span class="line">              <span class="variable">.i_g</span>    (w_g        ),</span><br><span class="line">              <span class="variable">.o_c</span>    (w_c        )</span><br><span class="line">          );</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>tb文件</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 9th May 2024 20:06:46</span></span><br><span class="line"><span class="comment"> * Anthor: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Thursday, 9th May 2024 23:57:02</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: test bench for carry lookahead adder</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"><span class="keyword">module</span> m_adder_fast_top_tb;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Parameters</span></span><br><span class="line">    <span class="keyword">localparam</span>  NUM_BITS = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Ports</span></span><br><span class="line">    <span class="keyword">reg</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_a;</span><br><span class="line">    <span class="keyword">reg</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_b;</span><br><span class="line">    <span class="keyword">reg</span>  i_cin;</span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] o_sum;</span><br><span class="line">    <span class="keyword">wire</span>  o_cout;</span><br><span class="line"></span><br><span class="line">    m_adder_fast_top # (</span><br><span class="line">                         <span class="variable">.NUM_BITS</span>(NUM_BITS)</span><br><span class="line">                     )</span><br><span class="line">                     m_adder_fast_top_inst (</span><br><span class="line">                         <span class="variable">.i_a</span>(i_a),</span><br><span class="line">                         <span class="variable">.i_b</span>(i_b),</span><br><span class="line">                         <span class="variable">.i_cin</span>(i_cin),</span><br><span class="line">                         <span class="variable">.o_sum</span>(o_sum),</span><br><span class="line">                         <span class="variable">.o_cout</span>(o_cout)</span><br><span class="line">                     );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> <span class="keyword">begin</span></span><br><span class="line">        #<span class="number">10</span> i_a = {<span class="built_in">$random</span>} % <span class="number">16</span>;</span><br><span class="line">        i_b = {<span class="built_in">$random</span>} % <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        i_a = <span class="number">4'b0001</span>;</span><br><span class="line">        i_b = <span class="number">4'b0010</span>;</span><br><span class="line">        i_cin = <span class="number">1'b0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>RTL电路</p>
<figure>
<img src="https://s2.loli.net/2024/05/10/xJYA3l9MG7fQmtS.png" alt="image-20240510000233924">
<figcaption aria-hidden="true">image-20240510000233924</figcaption>
</figure>
<p>仿真结果</p>
<figure>
<img src="https://s2.loli.net/2024/05/10/q17Mhpcr6Hgfu9O.png" alt="image-20240510000357125">
<figcaption aria-hidden="true">image-20240510000357125</figcaption>
</figure>
<h3 id="乘法器">乘法器</h3>
<h4 id="使用参数化设计的带符号数补码乘法器">使用参数化设计的带符号数补码乘法器</h4>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 9th May 2024 21:58:06</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Thursday, 9th May 2024 22:45:51</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: multiplier with parameter NUM_BITS</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> m_mul #(</span><br><span class="line">    <span class="keyword">parameter</span> NUM_BITS = <span class="number">4</span></span><br><span class="line">) (</span><br><span class="line">    <span class="keyword">input</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_x,</span><br><span class="line">    <span class="keyword">input</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_y,</span><br><span class="line">    <span class="keyword">output</span> [NUM_BITS * <span class="number">2</span> - <span class="number">1</span>:<span class="number">0</span>] o_z</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] w_xy [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS * <span class="number">2</span> - <span class="number">1</span>:<span class="number">0</span>] w_temp [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">reg</span> [NUM_BITS * <span class="number">2</span> - <span class="number">1</span>:<span class="number">0</span>] r_z;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_z = r_z;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">genvar</span> i;</span><br><span class="line">    <span class="keyword">generate</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; NUM_BITS; i = i + <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">assign</span> w_xy[i] = i_x[i] ? i_y : {NUM_BITS{<span class="number">1'b0</span>}};</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">assign</span> w_temp[i] = {{(NUM_BITS-<span class="number">1</span>){<span class="number">1'b0</span>}}, <span class="number">1'b1</span>, ~w_xy[i][NUM_BITS-<span class="number">1</span>], w_xy[i][NUM_BITS-<span class="number">2</span>:<span class="number">0</span>]};</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (i == NUM_BITS - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">assign</span> w_temp[i] = {{(NUM_BITS-<span class="number">1</span>){<span class="number">1'b0</span>}}, <span class="number">1'b1</span>, w_xy[i][NUM_BITS-<span class="number">1</span>], ~w_xy[i][NUM_BITS-<span class="number">2</span>:<span class="number">0</span>]};</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">assign</span> w_temp[i] = {{(NUM_BITS){<span class="number">1'b0</span>}}, ~w_xy[i][NUM_BITS-<span class="number">1</span>], w_xy[i][NUM_BITS-<span class="number">2</span>:<span class="number">0</span>]};</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">endgenerate</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">integer</span> j;</span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        r_z = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; NUM_BITS; j = j + <span class="number">1</span>) <span class="keyword">begin</span></span><br><span class="line">            r_z = r_z + (w_temp[j] &lt;&lt; j);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>tb文件</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 9th May 2024 21:58:06</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Thursday, 9th May 2024 22:48:48</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: testbench for multiplier</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> m_mul_tb;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Parameters</span></span><br><span class="line">    <span class="keyword">localparam</span>  NUM_BITS = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ports</span></span><br><span class="line">    <span class="keyword">reg</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_x;</span><br><span class="line">    <span class="keyword">reg</span> [NUM_BITS - <span class="number">1</span>:<span class="number">0</span>] i_y;</span><br><span class="line">    <span class="keyword">wire</span> [NUM_BITS * <span class="number">2</span> - <span class="number">1</span>:<span class="number">0</span>] o_z;</span><br><span class="line"></span><br><span class="line">    m_mul # (</span><br><span class="line">              <span class="variable">.NUM_BITS</span>(NUM_BITS)</span><br><span class="line">          )</span><br><span class="line">          m_mul_inst (</span><br><span class="line">              <span class="variable">.i_x</span>(i_x),</span><br><span class="line">              <span class="variable">.i_y</span>(i_y),</span><br><span class="line">              <span class="variable">.o_z</span>(o_z)</span><br><span class="line">          );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> <span class="keyword">begin</span></span><br><span class="line">        #<span class="number">10</span></span><br><span class="line">        i_x = <span class="built_in">$random</span> % <span class="number">8</span>;</span><br><span class="line">        i_y = <span class="built_in">$random</span> % <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        i_x = <span class="number">4'b0001</span>;</span><br><span class="line">        i_y = <span class="number">4'b0010</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>RTL电路</p>
<figure>
<img src="https://s2.loli.net/2024/05/09/6Gw2xURfdyXpImv.png" alt="image-20240509225123110">
<figcaption aria-hidden="true">image-20240509225123110</figcaption>
</figure>
<p>仿真结果</p>
<figure>
<img src="https://s2.loli.net/2024/05/09/Az7yD5P2VCIptZc.png" alt="image-20240509225154373">
<figcaption aria-hidden="true">image-20240509225154373</figcaption>
</figure>
<h3 id="总线操作">总线操作</h3>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Friday, 10th May 2024 11:36:27</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Wednesday, 15th May 2024 16:57:21</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: Testbench for bus operation</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"><span class="keyword">module</span> bus_operation_tb;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Parameters</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ports</span></span><br><span class="line">    <span class="keyword">reg</span>  i_write;</span><br><span class="line">    <span class="keyword">reg</span>  i_link_bus;</span><br><span class="line">    <span class="keyword">wire</span> [<span class="number">11</span>:<span class="number">0</span>] io_data_bus;</span><br><span class="line"></span><br><span class="line">    bus_operation  bus_operation_inst (</span><br><span class="line">                       <span class="variable">.i_write</span>(i_write),</span><br><span class="line">                       <span class="variable">.i_link_bus</span>(i_link_bus),</span><br><span class="line">                       <span class="variable">.io_data_bus</span>(io_data_bus)</span><br><span class="line">                   );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        i_write = <span class="number">1'b0</span>;</span><br><span class="line">        i_link_bus = <span class="number">1'b0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> #<span class="number">200</span> i_link_bus = ~i_link_bus;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> i_link_bus) <span class="keyword">begin</span></span><br><span class="line">        #<span class="number">5</span> i_write = <span class="number">1'b1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">negedge</span> i_link_bus) <span class="keyword">begin</span></span><br><span class="line">        #<span class="number">5</span> i_write = <span class="number">1'b0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> <span class="variable">#({$random} % 30)</span></span><br><span class="line">        <span class="comment">// if (i_link_bus == 1'b0)</span></span><br><span class="line">            <span class="keyword">force</span> io_data_bus = {<span class="built_in">$random</span>} % <span class="number">4096</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure>
<img src="https://s2.loli.net/2024/05/15/jWLhk2aZUxin5GD.png" alt="image-20240515164948530">
<figcaption aria-hidden="true">image-20240515164948530</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/15/LHAZ5wtS17pqjIB.png" alt="image-20240515165840189">
<figcaption aria-hidden="true">image-20240515165840189</figcaption>
</figure>
<h3 id="八选一数据选择器">八选一数据选择器</h3>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Friday, 10th May 2024 10:15:47</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Friday, 10th May 2024 11:22:56</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: 8-1 multiplexer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> multiplexer_8 #(</span><br><span class="line">    <span class="keyword">parameter</span> DATA_BIT_WIDTH = <span class="number">8</span></span><br><span class="line">) (</span><br><span class="line">    <span class="keyword">input</span> i_cs_n,       <span class="comment">// chip select (active low)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] i_sel,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_0,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_1,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_2,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_3,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_4,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_5,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_6,</span><br><span class="line">    <span class="keyword">input</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_7,</span><br><span class="line"></span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] o_data</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @(*) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (!i_cs_n)</span><br><span class="line">            <span class="keyword">case</span> (i_sel)</span><br><span class="line">                <span class="number">3'b000</span>: o_data = i_data_0;</span><br><span class="line">                <span class="number">3'b001</span>: o_data = i_data_1;</span><br><span class="line">                <span class="number">3'b010</span>: o_data = i_data_2;</span><br><span class="line">                <span class="number">3'b011</span>: o_data = i_data_3;</span><br><span class="line">                <span class="number">3'b100</span>: o_data = i_data_4;</span><br><span class="line">                <span class="number">3'b101</span>: o_data = i_data_5;</span><br><span class="line">                <span class="number">3'b110</span>: o_data = i_data_6;</span><br><span class="line">                <span class="number">3'b111</span>: o_data = i_data_7;</span><br><span class="line">                <span class="keyword">default</span>: o_data = {DATA_BIT_WIDTH{<span class="number">1'bz</span>}};</span><br><span class="line">            <span class="keyword">endcase</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            o_data = {DATA_BIT_WIDTH{<span class="number">1'bz</span>}};</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Friday, 10th May 2024 11:18:53</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Friday, 10th May 2024 11:27:06</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: Testbench for 8-1 multiplexer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"><span class="keyword">module</span> multiplexer_8_tb;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Parameters</span></span><br><span class="line">    <span class="keyword">localparam</span>  DATA_BIT_WIDTH = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ports</span></span><br><span class="line">    <span class="keyword">reg</span>  i_cs_n;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] i_sel;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_0;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_1;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_2;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_3;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_4;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_5;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_6;</span><br><span class="line">    <span class="keyword">reg</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] i_data_7;</span><br><span class="line">    <span class="keyword">wire</span> [DATA_BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] o_data;</span><br><span class="line"></span><br><span class="line">    multiplexer_8 # (</span><br><span class="line">                      <span class="variable">.DATA_BIT_WIDTH</span>(DATA_BIT_WIDTH)</span><br><span class="line">                  )</span><br><span class="line">                  multiplexer_8_inst (</span><br><span class="line">                      <span class="variable">.i_cs_n</span>(i_cs_n),</span><br><span class="line">                      <span class="variable">.i_sel</span>(i_sel),</span><br><span class="line">                      <span class="variable">.i_data_0</span>(i_data_0),</span><br><span class="line">                      <span class="variable">.i_data_1</span>(i_data_1),</span><br><span class="line">                      <span class="variable">.i_data_2</span>(i_data_2),</span><br><span class="line">                      <span class="variable">.i_data_3</span>(i_data_3),</span><br><span class="line">                      <span class="variable">.i_data_4</span>(i_data_4),</span><br><span class="line">                      <span class="variable">.i_data_5</span>(i_data_5),</span><br><span class="line">                      <span class="variable">.i_data_6</span>(i_data_6),</span><br><span class="line">                      <span class="variable">.i_data_7</span>(i_data_7),</span><br><span class="line">                      <span class="variable">.o_data</span>(o_data)</span><br><span class="line">                  );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">        i_cs_n = <span class="number">1'b1</span>;</span><br><span class="line">        i_data_0 = <span class="number">8'd0</span>;</span><br><span class="line">        i_data_1 = <span class="number">8'd1</span>;</span><br><span class="line">        i_data_2 = <span class="number">8'd2</span>;</span><br><span class="line">        i_data_3 = <span class="number">8'd3</span>;</span><br><span class="line">        i_data_4 = <span class="number">8'd4</span>;</span><br><span class="line">        i_data_5 = <span class="number">8'd5</span>;</span><br><span class="line">        i_data_6 = <span class="number">8'd6</span>;</span><br><span class="line">        i_data_7 = <span class="number">8'd7</span>;</span><br><span class="line"></span><br><span class="line">        #<span class="number">20</span> i_cs_n = <span class="number">1'b0</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> <span class="variable">#({$random} % 10)</span> i_sel = {<span class="built_in">$random</span>} % <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure>
<img src="https://s2.loli.net/2024/05/10/2hsyzGLbmMFWaCd.png" alt="image-20240510113224359">
<figcaption aria-hidden="true">image-20240510113224359</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/10/NSg8GvqpPMKQUoz.png" alt="image-20240510112739108">
<figcaption aria-hidden="true">image-20240510112739108</figcaption>
</figure>
<h2 id="实验2流水线">实验2（流水线）</h2>
<h3 id="流水线加法器">流水线加法器</h3>
<figure>
<img src="https://s2.loli.net/2024/05/11/D7gJsiK9HUWc2bE.png" alt="image-20240511191350966">
<figcaption aria-hidden="true">image-20240511191350966</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/11/jAcYvsg9tkfQ4T2.png" alt="image-20240511185428856">
<figcaption aria-hidden="true">image-20240511185428856</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/11/Zu3NbfTYeJrFzXA.png" alt="image-20240511190028110">
<figcaption aria-hidden="true">image-20240511190028110</figcaption>
</figure>
<h3 id="流水线乘法器">流水线乘法器</h3>
<figure>
<img src="https://s2.loli.net/2024/05/11/o3gC8atINDGfBEU.png" alt="image-20240511191714349">
<figcaption aria-hidden="true">image-20240511191714349</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/11/KZNCtQlE8JeS1HU.png" alt="image-20240511191817544">
<figcaption aria-hidden="true">image-20240511191817544</figcaption>
</figure>
<h2 id="实验3序列发生器">实验3（序列发生器）</h2>
<h3 id="case1使用移位寄存器">case1：使用移位寄存器</h3>
<figure>
<img src="https://s2.loli.net/2024/05/16/4th65FZvYGmzJps.png" alt="image-20240516183519566">
<figcaption aria-hidden="true">image-20240516183519566</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/16/iRYstq4X95jlFWB.png" alt="image-20240516183436275">
<figcaption aria-hidden="true">image-20240516183436275</figcaption>
</figure>
<h3 id="case2使用移位寄存器和组合反馈电路">case2：使用移位寄存器和组合反馈电路</h3>
<p>第一种设计的弊端在于数据输入端<code>i_d</code>的位数必须和要循环的序列长度相等。为了减少数据输入端的个数，才有了下面两种设计。</p>
<p>波形的序列是<code>111001</code>而不是<code>100111</code>，后续可以尝试排查一下问题。但是实际上问题不大，无论输入给了什么值输出都将回到这个回环，只是数据稳定所需要的时间不同，最长需要六个时钟周期。</p>
<figure>
<img src="https://s2.loli.net/2024/05/16/Ab8fhDr1cqjktaE.png" alt="image-20240516184718780">
<figcaption aria-hidden="true">image-20240516184718780</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/16/FB3fi6SPnxp4TuA.png" alt="image-20240516184743947">
<figcaption aria-hidden="true">image-20240516184743947</figcaption>
</figure>
<p>这里RTL模块综合出了一个<code>RTL_ROM</code>，很奇怪，预期的设计应该是由逻辑门组成的电路，而不是一块存储器，可能存在问题，可以将always语句块生成的组合逻辑电路改成化简后的与非门实现。</p>
<p>使用组合逻辑电路化简后实现：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 16th May 2024 16:17:31</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Thursday, 16th May 2024 18:45:30</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: serial signal generator using shift register</span></span><br><span class="line"><span class="comment"> *           and conbinational logic feedback</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> serial_signal_2 (</span><br><span class="line">    <span class="keyword">input</span> i_clk,</span><br><span class="line">    <span class="keyword">input</span> i_load,</span><br><span class="line">    <span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] i_d,</span><br><span class="line">    <span class="keyword">output</span> o_data_out</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">wire</span> w_f;</span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] r_q;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_data_out = r_q[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> i_clk) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (i_load)</span><br><span class="line">            r_q &lt;= i_d;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r_q &lt;= {r_q[<span class="number">2</span>:<span class="number">0</span>], w_f};</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> w_f = ~(r_q[<span class="number">1</span>] &amp; r_q[<span class="number">2</span>] &amp; r_q[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="https://s2.loli.net/2024/05/22/r1lvdZu6FASpi89.png" alt="image-20240522171445506">
<figcaption aria-hidden="true">image-20240522171445506</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/22/ndSQxIiFl8ryuMp.png" alt="image-20240522171337256">
<figcaption aria-hidden="true">image-20240522171337256</figcaption>
</figure>
<h3 id="case3使用计数器">case3：使用计数器</h3>
<p>第三种设计直接不需要数据输入端。</p>
<figure>
<img src="https://s2.loli.net/2024/05/16/G987BcQtxzS4Ti6.png" alt="image-20240516185713716">
<figcaption aria-hidden="true">image-20240516185713716</figcaption>
</figure>
<p><del>不能这样写，否则综合器会认为有多个同步或者异步信号会执行复位操作，会报出一个<code>critical warning</code>。</del></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> i_clk <span class="keyword">or</span> <span class="keyword">posedge</span> i_reset) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (i_reset &amp;&amp; r_cnt == <span class="number">'d5</span>)</span><br><span class="line">        r_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r_cnt &lt;= r_cnt + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>要修改成：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> i_clk <span class="keyword">or</span> <span class="keyword">posedge</span> i_reset) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (i_reset)</span><br><span class="line">        r_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (r_cnt == <span class="number">'d5</span>)</span><br><span class="line">        r_cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r_cnt &lt;= r_cnt + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>非常蠢的错误，逻辑应该是或不是与。合起来写没有问题，实际应该写成：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> i_clk <span class="keyword">or</span> <span class="keyword">posedge</span> i_reset) <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">if</span> (i_reset || r_cnt == <span class="number">'d5</span>)</span><br><span class="line">        r_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r_cnt &lt;= r_cnt + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="https://s2.loli.net/2024/05/16/UjIw84Ogeb1MGfs.png" alt="image-20240516190117708">
<figcaption aria-hidden="true">image-20240516190117708</figcaption>
</figure>
<p>这里不仅生成了<code>RTL_ROM</code>，还生成了<code>latch</code>，后续可以尝试解决一下。</p>
<p>使用组合逻辑语句：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * File Created: Thursday, 16th May 2024 16:06:05</span></span><br><span class="line"><span class="comment"> * Author: Yun Zhang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Last Modified: Sunday, 19th May 2024 22:04:00</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Function: serial signal generator using counter and conbinational logic</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> serial_signal_3 #(</span><br><span class="line">    <span class="keyword">parameter</span> BIT_WIDTH = <span class="number">3</span></span><br><span class="line">) (</span><br><span class="line">    <span class="keyword">input</span> <span class="keyword">wire</span> i_clk,</span><br><span class="line">    <span class="keyword">input</span> i_reset,</span><br><span class="line">    <span class="keyword">output</span> o_data_out</span><br><span class="line">);</span><br><span class="line">    <span class="keyword">reg</span> [BIT_WIDTH-<span class="number">1</span>:<span class="number">0</span>] r_cnt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> i_clk <span class="keyword">or</span> <span class="keyword">posedge</span> i_reset) <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span> (i_reset)</span><br><span class="line">            r_cnt &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (r_cnt == <span class="number">'d5</span>)</span><br><span class="line">            r_cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r_cnt &lt;= r_cnt + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assign</span> o_data_out = r_cnt[<span class="number">2</span>] | (r_cnt[<span class="number">1</span>] ~^ r_cnt[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="https://s2.loli.net/2024/05/22/G67YUKXvcpsBArZ.png" alt="image-20240522174516467">
<figcaption aria-hidden="true">image-20240522174516467</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/22/NlrxbiyDjaS753o.png" alt="image-20240522174532285">
<figcaption aria-hidden="true">image-20240522174532285</figcaption>
</figure>
<p>合并<code>always</code>语句块中的第一句和第二句：</p>
<figure>
<img src="https://s2.loli.net/2024/05/22/iw3Yu92SF5LNGgl.png" alt="image-20240522175229501">
<figcaption aria-hidden="true">image-20240522175229501</figcaption>
</figure>
<h2 id="实验4">实验4</h2>
<p>单端口RAM和双端口RAM的区别是地址总线的组数不同。单端口只有一个端口，同一时刻只能执行读操作或者写操作；双端口RAM有两套地址总线，可以形成两个独立的读写通道，读写的时钟也可以是异步的，即读写的时钟可以有两个。</p>
<h3 id="rom">ROM</h3>
<figure>
<img src="https://s2.loli.net/2024/05/23/2RJPvQNzu7gaeFq.png" alt="image-20240523164800574">
<figcaption aria-hidden="true">image-20240523164800574</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/23/za21PbUMVpgw8GA.png" alt="image-20240523164605921">
<figcaption aria-hidden="true">image-20240523164605921</figcaption>
</figure>
<h3 id="单端口ram">单端口RAM</h3>
<figure>
<img src="https://s2.loli.net/2024/05/23/VKpBSuEiOLUmHTR.png" alt="image-20240523165500084">
<figcaption aria-hidden="true">image-20240523165500084</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/23/uHkQERcSWbnf9Ui.png" alt="image-20240523165559752">
<figcaption aria-hidden="true">image-20240523165559752</figcaption>
</figure>
<h3 id="双端口ram">双端口RAM</h3>
<figure>
<img src="https://s2.loli.net/2024/05/23/Z8PjXE5y3wrbMl6.png" alt="image-20240523172226583">
<figcaption aria-hidden="true">image-20240523172226583</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2024/05/23/xheE6CmDsWpkKQT.png" alt="image-20240523172151471">
<figcaption aria-hidden="true">image-20240523172151471</figcaption>
</figure>
<h2 id="实验5">实验5</h2>
<p>仅<code>m_uart_tx</code>模块：</p>
<figure>
<img src="https://s2.loli.net/2024/05/30/AEuzyX475VGI2eZ.png" alt="image-20240530193225898">
<figcaption aria-hidden="true">image-20240530193225898</figcaption>
</figure>
<p><del>仿真跑通了，但是RTL分析报错</del> RTL分析
<em>完全看不清</em></p>
<figure>
<img src="https://s2.loli.net/2024/05/30/jAsFKN64f3UrkTY.png" alt="image-20240530192421704">
<figcaption aria-hidden="true">image-20240530192421704</figcaption>
</figure>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Yun Zhang, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2024/05/12/fpga-camera-isp/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">fpga_camera_isp</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2024/05/06/English-words/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">六级复习</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blogs</h2>
                
                <a href="/" class="item">Blogs</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/projects" class="item">Projects</a>
                
                <a href="/resume" class="item">Resume</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">About Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/sukiDebussy" class="item">GitHub</a>
                
                <a href="zydajuanb@gmail.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Yun Zhang<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        <br>
        <span class="footer-extra-description">追逐梦想就是追逐自己的厄运.</span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>